(function(){var f=(function(){var r={};var s=[];r.inc=function(u,t){return true};r.register=function(v,t){var x=v.split(".");var w=r;var u=null;while(u=x.shift()){if(x.length){if(w[u]===undefined){w[u]={}}w=w[u]}else{if(w[u]===undefined){try{w[u]=t(r)}catch(y){}}}}};r.regShort=function(t,u){if(r[t]!==undefined){throw"["+t+"] : short : has been register"}r[t]=u};r.IE=/msie/i.test(navigator.userAgent);r.E=function(t){if(typeof t==="string"){return document.getElementById(t)}else{return t}};r.C=function(t){var u;t=t.toUpperCase();if(t=="TEXT"){u=document.createTextNode("")}else{if(t=="BUFFER"){u=document.createDocumentFragment()}else{u=document.createElement(t)}}return u};r.log=function(t){s.push("["+((new Date()).getTime()%100000)+"]: "+t)};r.getErrorLogInformationList=function(t){return s.splice(0,t||s.length)};return r})();$Import=f.inc;f.register("core.arr.indexOf",function(r){return function(u,v){if(v.indexOf){return v.indexOf(u)}for(var t=0,s=v.length;t<s;t++){if(v[t]===u){return t}}return -1}});f.register("core.arr.inArray",function(r){return function(s,t){return r.core.arr.indexOf(s,t)>-1}});f.register("core.func.getType",function(r){return function(s){var t;return((t=typeof(s))=="object"?s==null&&"null"||Object.prototype.toString.call(s).slice(8,-1):t).toLowerCase()}});f.register("core.dom.sizzle",function(A){var G=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,z=0,u=Object.prototype.toString,F=false,y=true;[0,0].sort(function(){y=false;return 0});var s=function(N,I,Q,R){Q=Q||[];I=I||document;var T=I;if(I.nodeType!==1&&I.nodeType!==9){return[]}if(!N||typeof N!=="string"){return Q}var O=[],K,V,Y,J,M=true,L=s.isXML(I),S=N,U,X,W,P;do{G.exec("");K=G.exec(S);if(K){S=K[3];O.push(K[1]);if(K[2]){J=K[3];break}}}while(K);if(O.length>1&&B.exec(N)){if(O.length===2&&v.relative[O[0]]){V=x(O[0]+O[1],I)}else{V=v.relative[O[0]]?[I]:s(O.shift(),I);while(O.length){N=O.shift();if(v.relative[N]){N+=O.shift()}V=x(N,V)}}}else{if(!R&&O.length>1&&I.nodeType===9&&!L&&v.match.ID.test(O[0])&&!v.match.ID.test(O[O.length-1])){U=s.find(O.shift(),I,L);I=U.expr?s.filter(U.expr,U.set)[0]:U.set[0]}if(I){U=R?{expr:O.pop(),set:r(R)}:s.find(O.pop(),O.length===1&&(O[0]==="~"||O[0]==="+")&&I.parentNode?I.parentNode:I,L);V=U.expr?s.filter(U.expr,U.set):U.set;if(O.length>0){Y=r(V)}else{M=false}while(O.length){X=O.pop();W=X;if(!v.relative[X]){X=""}else{W=O.pop()}if(W==null){W=I}v.relative[X](Y,W,L)}}else{Y=O=[]}}if(!Y){Y=V}if(!Y){s.error(X||N)}if(u.call(Y)==="[object Array]"){if(!M){Q.push.apply(Q,Y)}else{if(I&&I.nodeType===1){for(P=0;Y[P]!=null;P++){if(Y[P]&&(Y[P]===true||Y[P].nodeType===1&&s.contains(I,Y[P]))){Q.push(V[P])}}}else{for(P=0;Y[P]!=null;P++){if(Y[P]&&Y[P].nodeType===1){Q.push(V[P])}}}}}else{r(Y,Q)}if(J){s(J,T,Q,R);s.uniqueSort(Q)}return Q};s.uniqueSort=function(J){if(t){F=y;J.sort(t);if(F){for(var I=1;I<J.length;I++){if(J[I]===J[I-1]){J.splice(I--,1)}}}}return J};s.matches=function(I,J){return s(I,null,null,J)};s.find=function(P,I,Q){var O;if(!P){return[]}for(var L=0,K=v.order.length;L<K;L++){var N=v.order[L],M;if((M=v.leftMatch[N].exec(P))){var J=M[1];M.splice(1,1);if(J.substr(J.length-1)!=="\\"){M[1]=(M[1]||"").replace(/\\/g,"");O=v.find[N](M,I,Q);if(O!=null){P=P.replace(v.match[N],"");break}}}}if(!O){O=I.getElementsByTagName("*")}return{set:O,expr:P}};s.filter=function(T,S,W,M){var K=T,Y=[],Q=S,O,I,P=S&&S[0]&&s.isXML(S[0]);while(T&&S.length){for(var R in v.filter){if((O=v.leftMatch[R].exec(T))!=null&&O[2]){var J=v.filter[R],X,V,L=O[1];I=false;O.splice(1,1);if(L.substr(L.length-1)==="\\"){continue}if(Q===Y){Y=[]}if(v.preFilter[R]){O=v.preFilter[R](O,Q,W,Y,M,P);if(!O){I=X=true}else{if(O===true){continue}}}if(O){for(var N=0;(V=Q[N])!=null;N++){if(V){X=J(V,O,N,Q);var U=M^!!X;if(W&&X!=null){if(U){I=true}else{Q[N]=false}}else{if(U){Y.push(V);I=true}}}}}if(X!==undefined){if(!W){Q=Y}T=T.replace(v.match[R],"");if(!I){return[]}break}}}if(T===K){if(I==null){s.error(T)}else{break}}K=T}return Q};s.error=function(I){throw"Syntax error, unrecognized expression: "+I};var v={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(I){return I.getAttribute("href")}},relative:{"+":function(O,J){var L=typeof J==="string",N=L&&!/\W/.test(J),P=L&&!N;if(N){J=J.toLowerCase()}for(var K=0,I=O.length,M;K<I;K++){if((M=O[K])){while((M=M.previousSibling)&&M.nodeType!==1){}O[K]=P||M&&M.nodeName.toLowerCase()===J?M||false:M===J}}if(P){s.filter(J,O,true)}},">":function(O,J){var M=typeof J==="string",N,K=0,I=O.length;if(M&&!/\W/.test(J)){J=J.toLowerCase();for(;K<I;K++){N=O[K];if(N){var L=N.parentNode;O[K]=L.nodeName.toLowerCase()===J?L:false}}}else{for(;K<I;K++){N=O[K];if(N){O[K]=M?N.parentNode:N.parentNode===J}}if(M){s.filter(J,O,true)}}},"":function(L,J,N){var K=z++,I=H,M;if(typeof J==="string"&&!/\W/.test(J)){J=J.toLowerCase();M=J;I=E}I("parentNode",J,K,L,M,N)},"~":function(L,J,N){var K=z++,I=H,M;if(typeof J==="string"&&!/\W/.test(J)){J=J.toLowerCase();M=J;I=E}I("previousSibling",J,K,L,M,N)}},find:{ID:function(J,K,L){if(typeof K.getElementById!=="undefined"&&!L){var I=K.getElementById(J[1]);return I?[I]:[]}},NAME:function(K,N){if(typeof N.getElementsByName!=="undefined"){var J=[],M=N.getElementsByName(K[1]);for(var L=0,I=M.length;L<I;L++){if(M[L].getAttribute("name")===K[1]){J.push(M[L])}}return J.length===0?null:J}},TAG:function(I,J){return J.getElementsByTagName(I[1])}},preFilter:{CLASS:function(L,J,K,I,O,P){L=" "+L[1].replace(/\\/g,"")+" ";if(P){return L}for(var M=0,N;(N=J[M])!=null;M++){if(N){if(O^(N.className&&(" "+N.className+" ").replace(/[\t\n]/g," ").indexOf(L)>=0)){if(!K){I.push(N)}}else{if(K){J[M]=false}}}}return false},ID:function(I){return I[1].replace(/\\/g,"")},TAG:function(J,I){return J[1].toLowerCase()},CHILD:function(I){if(I[1]==="nth"){var J=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(I[2]==="even"&&"2n"||I[2]==="odd"&&"2n+1"||!/\D/.test(I[2])&&"0n+"+I[2]||I[2]);I[2]=(J[1]+(J[2]||1))-0;I[3]=J[3]-0}I[0]=z++;return I},ATTR:function(M,J,K,I,N,O){var L=M[1].replace(/\\/g,"");if(!O&&v.attrMap[L]){M[1]=v.attrMap[L]}if(M[2]==="~="){M[4]=" "+M[4]+" "}return M},PSEUDO:function(M,J,K,I,N){if(M[1]==="not"){if((G.exec(M[3])||"").length>1||/^\w/.test(M[3])){M[3]=s(M[3],null,null,J)}else{var L=s.filter(M[3],J,K,true^N);if(!K){I.push.apply(I,L)}return false}}else{if(v.match.POS.test(M[0])||v.match.CHILD.test(M[0])){return true}}return M},POS:function(I){I.unshift(true);return I}},filters:{enabled:function(I){return I.disabled===false&&I.type!=="hidden"},disabled:function(I){return I.disabled===true},checked:function(I){return I.checked===true},selected:function(I){I.parentNode.selectedIndex;return I.selected===true},parent:function(I){return !!I.firstChild},empty:function(I){return !I.firstChild},has:function(K,J,I){return !!s(I[3],K).length},header:function(I){return(/h\d/i).test(I.nodeName)},text:function(I){return"text"===I.type},radio:function(I){return"radio"===I.type},checkbox:function(I){return"checkbox"===I.type},file:function(I){return"file"===I.type},password:function(I){return"password"===I.type},submit:function(I){return"submit"===I.type},image:function(I){return"image"===I.type},reset:function(I){return"reset"===I.type},button:function(I){return"button"===I.type||I.nodeName.toLowerCase()==="button"},input:function(I){return(/input|select|textarea|button/i).test(I.nodeName)}},setFilters:{first:function(J,I){return I===0},last:function(K,J,I,L){return J===L.length-1},even:function(J,I){return I%2===0},odd:function(J,I){return I%2===1},lt:function(K,J,I){return J<I[3]-0},gt:function(K,J,I){return J>I[3]-0},nth:function(K,J,I){return I[3]-0===J},eq:function(K,J,I){return I[3]-0===J}},filter:{PSEUDO:function(K,P,O,Q){var I=P[1],J=v.filters[I];if(J){return J(K,O,P,Q)}else{if(I==="contains"){return(K.textContent||K.innerText||s.getText([K])||"").indexOf(P[3])>=0}else{if(I==="not"){var L=P[3];for(var N=0,M=L.length;N<M;N++){if(L[N]===K){return false}}return true}else{s.error("Syntax error, unrecognized expression: "+I)}}}},CHILD:function(I,L){var O=L[1],J=I;switch(O){case"only":case"first":while((J=J.previousSibling)){if(J.nodeType===1){return false}}if(O==="first"){return true}J=I;case"last":while((J=J.nextSibling)){if(J.nodeType===1){return false}}return true;case"nth":var K=L[2],R=L[3];if(K===1&&R===0){return true}var N=L[0],Q=I.parentNode;if(Q&&(Q.sizcache!==N||!I.nodeIndex)){var M=0;for(J=Q.firstChild;J;J=J.nextSibling){if(J.nodeType===1){J.nodeIndex=++M}}Q.sizcache=N}var P=I.nodeIndex-R;if(K===0){return P===0}else{return(P%K===0&&P/K>=0)}}},ID:function(J,I){return J.nodeType===1&&J.getAttribute("id")===I},TAG:function(J,I){return(I==="*"&&J.nodeType===1)||J.nodeName.toLowerCase()===I},CLASS:function(J,I){return(" "+(J.className||J.getAttribute("class"))+" ").indexOf(I)>-1},ATTR:function(N,L){var K=L[1],I=v.attrHandle[K]?v.attrHandle[K](N):N[K]!=null?N[K]:N.getAttribute(K),O=I+"",M=L[2],J=L[4];return I==null?M==="!=":M==="="?O===J:M==="*="?O.indexOf(J)>=0:M==="~="?(" "+O+" ").indexOf(J)>=0:!J?O&&I!==false:M==="!="?O!==J:M==="^="?O.indexOf(J)===0:M==="$="?O.substr(O.length-J.length)===J:M==="|="?O===J||O.substr(0,J.length+1)===J+"-":false},POS:function(M,J,K,N){var I=J[2],L=v.setFilters[I];if(L){return L(M,K,J,N)}}}};s.selectors=v;var B=v.match.POS,w=function(J,I){return"\\"+(I-0+1)};for(var D in v.match){v.match[D]=new RegExp(v.match[D].source+(/(?![^\[]*\])(?![^\(]*\))/.source));v.leftMatch[D]=new RegExp(/(^(?:.|\r|\n)*?)/.source+v.match[D].source.replace(/\\(\d+)/g,w))}var r=function(J,I){J=Array.prototype.slice.call(J,0);if(I){I.push.apply(I,J);return I}return J};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(C){r=function(M,L){var J=L||[],K=0;if(u.call(M)==="[object Array]"){Array.prototype.push.apply(J,M)}else{if(typeof M.length==="number"){for(var I=M.length;K<I;K++){J.push(M[K])}}else{for(;M[K];K++){J.push(M[K])}}}return J}}var t;if(document.documentElement.compareDocumentPosition){t=function(J,I){if(!J.compareDocumentPosition||!I.compareDocumentPosition){if(J==I){F=true}return J.compareDocumentPosition?-1:1}var K=J.compareDocumentPosition(I)&4?-1:J===I?0:1;if(K===0){F=true}return K}}else{if("sourceIndex" in document.documentElement){t=function(J,I){if(!J.sourceIndex||!I.sourceIndex){if(J==I){F=true}return J.sourceIndex?-1:1}var K=J.sourceIndex-I.sourceIndex;if(K===0){F=true}return K}}else{if(document.createRange){t=function(L,J){if(!L.ownerDocument||!J.ownerDocument){if(L==J){F=true}return L.ownerDocument?-1:1}var K=L.ownerDocument.createRange(),I=J.ownerDocument.createRange();K.setStart(L,0);K.setEnd(L,0);I.setStart(J,0);I.setEnd(J,0);var M=K.compareBoundaryPoints(Range.START_TO_END,I);if(M===0){F=true}return M}}}}s.getText=function(I){var J="",L;for(var K=0;I[K];K++){L=I[K];if(L.nodeType===3||L.nodeType===4){J+=L.nodeValue}else{if(L.nodeType!==8){J+=s.getText(L.childNodes)}}}return J};(function(){var J=document.createElement("div"),K="script"+(new Date()).getTime();J.innerHTML="<a name='"+K+"'/>";var I=document.documentElement;I.insertBefore(J,I.firstChild);if(document.getElementById(K)){v.find.ID=function(M,N,O){if(typeof N.getElementById!=="undefined"&&!O){var L=N.getElementById(M[1]);return L?L.id===M[1]||typeof L.getAttributeNode!=="undefined"&&L.getAttributeNode("id").nodeValue===M[1]?[L]:undefined:[]}};v.filter.ID=function(N,L){var M=typeof N.getAttributeNode!=="undefined"&&N.getAttributeNode("id");return N.nodeType===1&&M&&M.nodeValue===L}}I.removeChild(J);I=J=null})();(function(){var I=document.createElement("div");I.appendChild(document.createComment(""));if(I.getElementsByTagName("*").length>0){v.find.TAG=function(J,N){var M=N.getElementsByTagName(J[1]);if(J[1]==="*"){var L=[];for(var K=0;M[K];K++){if(M[K].nodeType===1){L.push(M[K])}}M=L}return M}}I.innerHTML="<a href='#'></a>";if(I.firstChild&&typeof I.firstChild.getAttribute!=="undefined"&&I.firstChild.getAttribute("href")!=="#"){v.attrHandle.href=function(J){return J.getAttribute("href",2)}}I=null})();if(document.querySelectorAll){(function(){var I=s,K=document.createElement("div");K.innerHTML="<p class='TEST'></p>";if(K.querySelectorAll&&K.querySelectorAll(".TEST").length===0){return}s=function(O,N,L,M){N=N||document;if(!M&&N.nodeType===9&&!s.isXML(N)){try{return r(N.querySelectorAll(O),L)}catch(P){}}return I(O,N,L,M)};for(var J in I){s[J]=I[J]}K=null})()}(function(){var I=document.createElement("div");I.innerHTML="<div class='test e'></div><div class='test'></div>";if(!I.getElementsByClassName||I.getElementsByClassName("e").length===0){return}I.lastChild.className="e";if(I.getElementsByClassName("e").length===1){return}v.order.splice(1,0,"CLASS");v.find.CLASS=function(J,K,L){if(typeof K.getElementsByClassName!=="undefined"&&!L){return K.getElementsByClassName(J[1])}};I=null})();function E(J,O,N,R,P,Q){for(var L=0,K=R.length;L<K;L++){var I=R[L];if(I){I=I[J];var M=false;while(I){if(I.sizcache===N){M=R[I.sizset];break}if(I.nodeType===1&&!Q){I.sizcache=N;I.sizset=L}if(I.nodeName.toLowerCase()===O){M=I;break}I=I[J]}R[L]=M}}}function H(J,O,N,R,P,Q){for(var L=0,K=R.length;L<K;L++){var I=R[L];if(I){I=I[J];var M=false;while(I){if(I.sizcache===N){M=R[I.sizset];break}if(I.nodeType===1){if(!Q){I.sizcache=N;I.sizset=L}if(typeof O!=="string"){if(I===O){M=true;break}}else{if(s.filter(O,[I]).length>0){M=I;break}}}I=I[J]}R[L]=M}}}s.contains=document.compareDocumentPosition?function(J,I){return !!(J.compareDocumentPosition(I)&16)}:function(J,I){return J!==I&&(J.contains?J.contains(I):true)};s.isXML=function(I){var J=(I?I.ownerDocument||I:0).documentElement;return J?J.nodeName!=="HTML":false};var x=function(I,P){var L=[],M="",N,K=P.nodeType?[P]:P;while((N=v.match.PSEUDO.exec(I))){M+=N[0];I=I.replace(v.match.PSEUDO,"")}I=v.relative[I]?I+"*":I;for(var O=0,J=K.length;O<J;O++){s(I,K[O],L)}return s.filter(M,L)};return s});f.register("core.dom.builder",function(r){function s(A,w){if(w){return w}var v,y=/\<(\w+)[^>]*\s+node-type\s*=\s*([\'\"])?(\w+)\2.*?>/g;var x={};var z,u,t;while((v=y.exec(A))){u=v[1];z=v[3];t=u+"[node-type="+z+"]";x[z]=x[z]==null?[]:x[z];if(!r.core.arr.inArray(t,x[z])){x[z].push(u+"[node-type="+z+"]")}}return x}return function(x,w){var t=r.core.func.getType(x)=="string";var A=s(t?x:x.innerHTML,w);var u=x;if(t){u=r.C("div");u.innerHTML=x}var B,z,y;y=r.core.dom.sizzle("[node-type]",u);z={};for(B in A){z[B]=r.core.dom.sizzle.matches(A[B].toString(),y)}var v=x;if(t){v=r.C("buffer");while(u.children[0]){v.appendChild(u.children[0])}}return{box:v,list:z}}});f.register("core.dom.hasClassName",function(r){return function(t,s){return(new RegExp("\\b"+s+"\\b").test(t.className))}});f.register("core.dom.addClassName",function(r){return function(t,s){if(t.nodeType===1){if(!r.core.dom.hasClassName(t,s)){t.className+=(" "+s)}}}});f.register("core.obj.parseParam",function(r){return function(u,t,s){var v,w={};t=t||{};for(v in u){w[v]=u[v];if(t[v]!=null){if(s){if(u.hasOwnProperty[v]){w[v]=t[v]}}else{w[v]=t[v]}}}return w}});f.register("core.util.listener",function(r){return(function(){var v={};var s;var w=[];var u;function x(){if(w.length==0){return}clearTimeout(u);var y=w.splice(0,1)[0];try{y.func.apply(y.func,[].concat(y.data))}catch(z){r.log("[error][listener]: One of "+y+"-"+y+" function execute error.")}u=setTimeout(x,25)}var t={conn:function(){var y=window;while(y!=top){y=y.parent;if(y.STK&&y.STK["core"]&&y.STK["core"]["util"]&&y.STK["core"]["util"]["listener"]!=null){s=y}}},register:function(y,A,z){if(s!=null){s.STK["core"]["util"]["listener"].register(y,A,z)}else{v[y]=v[y]||{};v[y][A]=v[y][A]||[];v[y][A].push(z)}},fire:function(A,C,D){if(s!=null){s.listener.fire(A,C,D)}else{var B;var z,y;if(v[A]&&v[A][C]&&v[A][C].length>0){B=v[A][C];B.data_cache=D;for(z=0,y=B.length;z<y;z++){w.push({channel:A,evt:C,func:B[z],data:D})}x()}}},remove:function(A,C,B){if(s!=null){s.STK["core"]["util"]["listener"].remove(A,C,B)}else{if(v[A]){if(v[A][C]){for(var z=0,y=v[A][C].length;z<y;z++){if(v[A][C][z]===B){v[A][C].splice(z,1);break}}}}}},list:function(){return v},cache:function(y,z){if(s!=null){return s.listener.cache(y,z)}else{if(v[y]&&v[y][z]){return v[y][z].data_cache}}}};return t})()});f.register("core.util.easyTemplate",function(s){var r=function(u,w){if(!u){return""}if(u!==r.template){r.template=u;r.aStatement=r.parsing(r.separate(u))}var t=r.aStatement;var v=function(x){if(x){w=x}return arguments.callee};v.toString=function(){return(new Function(t[0],t[1]))(w)};return v};r.separate=function(t){var v=/\\'/g;var u=t.replace(/(<(\/?)#(.*?(?:\(.*?\))*)>)|(')|([\r\n\t])|(\$\{([^\}]*?)\})/g,function(x,w,D,C,B,A,z,y){if(w){return"{|}"+(D?"-":"+")+C+"{|}"}if(B){return"\\'"}if(A){return""}if(z){return"'+("+y.replace(v,"'")+")+'"}});return u};r.parsing=function(C){var B,v,y,u,x,w,z,A=["var aRet = [];"];z=C.split(/\{\|\}/);var t=/\s/;while(z.length){y=z.shift();if(!y){continue}x=y.charAt(0);if(x!=="+"&&x!=="-"){y="'"+y+"'";A.push("aRet.push("+y+");");continue}u=y.split(t);switch(u[0]){case"+et":B=u[1];v=u[2];A.push('aRet.push("<!--'+B+' start-->");');break;case"-et":A.push('aRet.push("<!--'+B+' end-->");');break;case"+if":u.splice(0,1);A.push("if"+u.join(" ")+"{");break;case"+elseif":u.splice(0,1);A.push("}else if"+u.join(" ")+"{");break;case"-if":A.push("}");break;case"+else":A.push("}else{");break;case"+list":A.push("if("+u[1]+".constructor === Array){with({i:0,l:"+u[1]+".length,"+u[3]+"_index:0,"+u[3]+":null}){for(i=l;i--;){"+u[3]+"_index=(l-i-1);"+u[3]+"="+u[1]+"["+u[3]+"_index];");break;case"-list":A.push("}}}");break;default:break}}A.push('return aRet.join("");');return[v,A.join("")]};return r});f.register("core.evt.addEvent",function(r){return function(s,v,u){var t=r.E(s);if(t==null){return false}v=v||"click";if((typeof u).toLowerCase()!="function"){return}if(t.attachEvent){t.attachEvent("on"+v,u)}else{if(t.addEventListener){t.addEventListener(v,u,false)}else{t["on"+v]=u}}return true}});f.register("core.evt.removeEvent",function(r){return function(t,v,u,s){var w=r.E(t);if(w==null){return false}if(typeof u!="function"){return false}if(w.removeEventListener){w.removeEventListener(v,u,s)}else{if(w.detachEvent){w.detachEvent("on"+v,u)}else{w["on"+v]=null}}return true}});f.register("core.arr.isArray",function(r){return function(s){return Object.prototype.toString.call(s)==="[object Array]"}});f.register("core.str.trim",function(r){return function(w){if(typeof w!=="string"){throw"trim need a string as parameter"}var t=w.length;var v=0;var u=/(\u3000|\s|\t|\u00A0)/;while(v<t){if(!u.test(w.charAt(v))){break}v+=1}while(t>v){if(!u.test(w.charAt(t-1))){break}t-=1}return w.slice(v,t)}});f.register("core.json.queryToJson",function(r){return function(u,y){var A=r.core.str.trim(u).split("&");var z={};var t=function(C){if(y){return decodeURIComponent(C)}else{return C}};for(var w=0,x=A.length;w<x;w++){if(A[w]){var v=A[w].split("=");var s=v[0];var B=v[1];if(v.length<2){B=s;s="$nullName"}if(!z[s]){z[s]=t(B)}else{if(r.core.arr.isArray(z[s])!=true){z[s]=[z[s]]}z[s].push(t(B))}}}return z}});f.register("core.dom.isNode",function(r){return function(s){return(s!=undefined)&&Boolean(s.nodeName)&&Boolean(s.nodeType)}});f.register("core.dom.contains",function(r){return function(s,t){if(s===t){return false}else{if(s.compareDocumentPosition){return((s.compareDocumentPosition(t)&16)===16)}else{if(s.contains&&t.nodeType===1){return s.contains(t)}else{while(t=t.parentNode){if(s===t){return true}}}}}return false}});f.register("core.util.browser",function(x){var r=navigator.userAgent.toLowerCase();var A=window.external||"";var t,u,v,B,w;var s=function(D){var E=0;return parseFloat(D.replace(/\./g,function(){return(E++==1)?"":"."}))};try{if((/windows|win32/i).test(r)){w="windows"}else{if((/macintosh/i).test(r)){w="macintosh"}else{if((/rhino/i).test(r)){w="rhino"}}}if((u=r.match(/applewebkit\/([^\s]*)/))&&u[1]){t="webkit";B=s(u[1])}else{if((u=r.match(/presto\/([\d.]*)/))&&u[1]){t="presto";B=s(u[1])}else{if(u=r.match(/msie\s([^;]*)/)){t="trident";B=1;if((u=r.match(/trident\/([\d.]*)/))&&u[1]){B=s(u[1])}}else{if(/gecko/.test(r)){t="gecko";B=1;if((u=r.match(/rv:([\d.]*)/))&&u[1]){B=s(u[1])}}}}}if(/world/.test(r)){v="world"}else{if(/360se/.test(r)){v="360"}else{if((/maxthon/.test(r))||typeof A.max_version=="number"){v="maxthon"}else{if(/tencenttraveler\s([\d.]*)/.test(r)){v="tt"}else{if(/se\s([\d.]*)/.test(r)){v="sogou"}}}}}}catch(z){}var C=r.indexOf("trident/7.0")!=-1&&(r.indexOf("rv 11.0")!=-1||r.indexOf("rv:11.0")!=-1);var y={OS:w,CORE:t,Version:B,EXTRA:(v?v:false),IE:/msie/.test(r)||C,OPERA:/opera/.test(r),MOZ:/gecko/.test(r)&&!/(compatible|webkit)/.test(r),IE5:/msie 5 /.test(r),IE55:/msie 5.5/.test(r),IE6:/msie 6/.test(r),IE7:/msie 7/.test(r),IE8:/msie 8/.test(r),IE9:/msie 9/.test(r),IE11:C,SAFARI:!/chrome\/([\d.]*)/.test(r)&&/\/([\d.]*) safari/.test(r),CHROME:/chrome\/([\d.]*)/.test(r),IPAD:/\(ipad/i.test(r),IPHONE:/\(iphone/i.test(r),ITOUCH:/\(itouch/i.test(r),MOBILE:/mobile/i.test(r)};return y});f.register("core.evt.getEvent",function(r){return function(){if(r.IE){return window.event}else{if(window.event){return window.event}var t=arguments.callee.caller;var s;var u=0;while(t!=null&&u<40){s=t.arguments[0];if(s&&(s.constructor==Event||s.constructor==MouseEvent||s.constructor==KeyboardEvent)){return s}u++;t=t.caller}return s}}});f.register("core.evt.fixEvent",function(r){return function(s){s=s||r.core.evt.getEvent();if(!s.target){s.target=s.srcElement;s.pageX=s.x;s.pageY=s.y}if(typeof s.layerX=="undefined"){s.layerX=s.offsetX}if(typeof s.layerY=="undefined"){s.layerY=s.offsetY}return s}});f.register("core.obj.isEmpty",function(r){return function(v,u){var t=true;for(var s in v){if(u){t=false;break}else{if(v.hasOwnProperty(s)){t=false;break}}}return t}});f.register("core.func.empty",function(){return function(){}});f.register("core.evt.delegatedEvent",function(s){var r=function(w,v){for(var u=0,t=w.length;u<t;u+=1){if(s.core.dom.contains(w[u],v)){return true}}return false};return function(u,x){if(!s.core.dom.isNode(u)){throw"core.evt.delegatedEvent need an Element as first Parameter"}if(!x){x=[]}if(s.core.arr.isArray(x)){x=[x]}var t={};var w=function(D){var z=s.core.evt.fixEvent(D);var C=z.target;var B=D.type;var E=function(){var H,F,G;H=C.getAttribute("action-target");if(H){F=s.core.dom.sizzle(H,u);if(F.length){G=z.target=F[0]}}E=s.core.func.empty;return G};var y=function(){var F=E()||C;if(t[B]&&t[B][A]){return t[B][A]({evt:z,el:F,box:u,data:s.core.json.queryToJson(F.getAttribute("action-data")||"")})}else{return true}};if(r(x,C)){return false}else{if(!s.core.dom.contains(u,C)){return false}else{var A=null;while(C&&C!==u){A=C.getAttribute("action-type");if(A&&y()===false){break}C=C.parentNode}}}};var v={};v.add=function(A,B,z){if(!t[B]){t[B]={};s.core.evt.addEvent(u,B,w)}var y=t[B];y[A]=z};v.remove=function(y,z){if(t[z]){delete t[z][y];if(s.core.obj.isEmpty(t[z])){delete t[z];s.core.evt.removeEvent(u,z,w)}}};v.pushExcept=function(y){x.push(y)};v.removeExcept=function(A){if(!A){x=[]}else{for(var z=0,y=x.length;z<y;z+=1){if(x[z]===A){x.splice(z,1)}}}};v.clearExcept=function(y){x=[]};v.destroy=function(){for(k in t){for(l in t[k]){delete t[k][l]}delete t[k];s.core.evt.removeEvent(u,k,w)}};return v}});f.register("core.json.jsonToQuery",function(r){var s=function(u,t){u=u==null?"":u;u=r.core.str.trim(u.toString());if(t){return encodeURIComponent(u)}else{return u}};return function(x,v){var y=[];if(typeof x=="object"){for(var u in x){if(u==="$nullName"){y=y.concat(x[u]);continue}if(x[u] instanceof Array){for(var w=0,t=x[u].length;w<t;w++){y.push(u+"="+s(x[u][w],v))}}else{if(typeof x[u]!="function"){y.push(u+"="+s(x[u],v))}}}}if(y.length){return y.join("&")}else{return""}}});f.register("kit.extra.clone",function(r){function s(x,t){t=t||false;var v;if(x instanceof Array){v=[];var w=x.length;while(w--){if(t){v[w]=s(x[w])}else{v[w]=x[w]}}return v}else{if(x instanceof Object){v={};for(var u in x){if(t){v[u]=s(x[u])}else{v[u]=x[u]}}return v}else{return x}}}return s});f.register("template.button.followButton",function(v){var u={};var t='<#et temp config><div class="WB_widgets WB_followButton"><div class="clearfix"><#if (config["show_head"] == true) ><div class="WB_UserAvatar"><img node-type="profilePic" alt="" src="${config.user.profile_image_url}"></div></#if><div class="WB_UserInfo" ${(config["show_head"] == true) ? \'\' : \'style="margin-left:0;"\'} ><#if (config["show_name"] == true) ><p class="WB_UserName" node-type="nameBox"><a href="http://www.weibo.com/${(config.user.domain != "") ? (config.user.domain) : (config.user.id)}" target="_blank" >${config.user.name}</a><#if (config.user.verified == true) > <span class="WB_approve"></span></#if></p></#if><p class="WB_UserStat" node-type="btnbox" ></p></div></div></div></#et>';var w='<#et temp data><span class="${data.btncss}" node-type="followBtn"><span> <em class="${data.imgcss}" node-type="followImg" ></em><em>${data.btntxt}</em><#if ((data.cancel == "true" || data.cancel == true) && (data.alias == "each" || data.alias == "has")) ><em class="WB_btnL">|</em><em><a href="javascript:void(0);" node-type="followCancel" class="W_linkb">取消</a></em></#if></span></span></#et>';var r='<#et temp config><div class="follow_btn_line" node-type="inner"><a class="follow_btn status_followed" node-type="followBtn" target="_blank" title="#L{已关注}" href="http://weibo.com/u/${config.uid}"><cite class="follow_btn_inner"><u class="WB_ico_logo"></u><cite class="follow_text">#L{新动态}</cite></cite></a></div></#et>';var s='<#et temp data><#if (data.style == 1) ><#elseif (data.style == 2) ><cite class="follow_data"><a title="${data.total} #L{粉丝}" target="_blank" href="http://weibo.com/${data.currentUser.profile_url}" class="data_link">${data.total}</a><cite class="data_arrow"></cite></cite><#elseif (data.style == 3) ><cite class="follow_intro"><a title="${data.currentUser.screen_name}" target="_blank" href="http://weibo.com/${data.currentUser.profile_url}" class="follow_name name_bold">${data.currentUser.screen_name}</a><#if (data.currentUser.vip_type == 1) ><u class="WB_ico_approve"></u><#elseif (data.currentUser.vip_type == 2) ><u class="WB_ico_approve_co"></u></#if><cite class="intro_data">(#L{粉丝}${data.total})</cite></cite><#elseif (data.style == 4) ><cite class="follow_intro"><#list data.user as user><#if (user_index == 0) ><a target="_blank" title="${user.screen_name}" href="http://weibo.com/${user.profile_url}" class="follower_name">${user.short_name}</a></#if></#list><cite class="follow_display">#L{等}${data.total}人#L{已关注}</cite></cite><div class="follow_list_container"><ul class="follower_list"><#list data.user as user><li class="follower_item"><a target="_blank" href="http://weibo.com/${user.profile_url}" class="follower_item_a"><img width="30" height="30" title="${user.screen_name}" alt="${user.screen_name}" src="${user.profile_image_url}" class="follower_item_a_img"></a></li></#list></ul></div></#if></#et>';u.layoutTemplate=t;u.buttonTemplate=w;u.buttonWithCardTemplete=r;u.fansTemplate=s;return u});f.register("common.tool",function(v){var u={};var t={};var s=function(x){WB2.parseCMD("/account/get_uid.json",function(z,y){if(y&&z.uid){x(z.uid,y)}else{x(y)}},{},{method:"get",cache_time:100})};var r=function(x,y){y=y||function(){};if(t[x]){y(t[x]);return}WB2.parseCMD("/users/show.json",function(A,z){t[x]=A;y(A)},{uid:x},{method:"get"})};var w=function(x,y){y=y||function(){};if(t[x]){y(t[x]);return}WB2.parseCMD("/users/show.json",function(A,z){t[x]=A;y(A)},{screen_name:encodeURIComponent(x)},{method:"get",cache_time:100})};u.getUid=s;u.loadCurrentUser=r;u.loadCurrentUserByName=w;return u});f.register("comp.button.followButton",function(u){var w={};var s=u.core.util.listener;var r=800;var x=function(C,B){u.common.tool.getUid(function(D){if(D===false){s.fire("followButton",C+"_add_follow");return}if(C==D){s.fire("followButton",C+"_is_me");return}else{z(C,B)}})};var A=function(C,B){var D=function(E){if(E){B&&B(E)}};u.common.tool.loadCurrentUser(C,D)};var t=function(B,C){var D=function(E){if(E){C&&C(E)}};u.common.tool.loadCurrentUserByName(B,D)};var z=function(B,C){WB2.parseCMD("/friendships/show.json",function(E,D){if(!D){s.fire("followButton",B+"_add_follow");return}if(E.source.following){if(E.source.followed_by){s.fire("followButton",B+"_each_follow")}else{s.fire("followButton",B+"_has_follow")}}else{s.fire("followButton",B+"_add_follow")}typeof C=="function"&&C()},{target_id:B},{method:"get"})};var v=function(B,C){WB2.parseCMD("/friendships/create.json",function(E,D){if(!D){if(E.error_code=="10025"){s.fire("followButton",B+"_is_me");return}if(E.error_code=="20506"){z(B);return}s.fire("followButton",B+"_add_follow");return}if(E&&(E.error_code=="20003")){s.fire("followButton",B+"_add_follow");return}typeof C=="function"&&C("create",E);setTimeout(function(){z(B)},r)},{uid:B},{method:"post"})};var y=function(B,C){WB2.parseCMD("/friendships/destroy.json",function(E,D){s.fire("followButton",B+"_add_follow");typeof C=="function"&&C("destroy",E)},{uid:B},{method:"post"})};w.loadUserByUid=A;w.loadUserByName=t;w.loadCurrentUser=x;w.loadFriendships=z;w.createFriendships=v;w.destroyFriendships=y;return w});f.register("common.iframe",function(r){return function(s){var t={};var v;var u=function(x){var w=r.core.obj.parseParam({id:"",url:"",name:"iframe_widget",root:null,width:"100%",height:"100%"},x);v=document.createElement("iframe");if(w.id){v.id=w.id}v.src=w.url;v.width=w.width;v.height=w.height;v.frameBorder=0;v.scrolling="no";v.marginHeight="0";v.marginwidth="0";v.allowTransparency="true";if(r.core.dom.isNode(w.root)){w.root.innerHTML="";w.root.appendChild(v)}else{throw"conf.root is not an avaliable dom element."}};t.insertIFrame=u;return t}});var d=f.core.evt.addEvent,i=f.core.evt.removeEvent,a=f.core.util.easyTemplate,b=f.core.util.listener,j=f.core.json.jsonToQuery,p=f.core.obj.parseParam;if(!WB2.listener){WB2.listener=b}var o=f.comp.button.followButton,m=f.template.button.followButton,h=a(m.layoutTemplate),c=a(m.buttonTemplate);var q=f.common.iframe();var n={add:{imgcss:"WB_btnicn_add",btncss:"WB_btnA",btntxt:"加关注",alias:"add"},has:{imgcss:"WB_btnicn_ok",btncss:"WB_btnC",btntxt:"已关注",alias:"has"},each:{imgcss:"WB_btnicn_each",btncss:"WB_btnC",btntxt:"相互关注",alias:"each"},me:{imgcss:"WB_btnicn_each",btncss:"WB_btnC",btntxt:"我自己",alias:"me"}};var g="http://service.t.sina.com.cn/widget/jssdk/followBtn.php";var e=function(D){var z=p({dom:null,id:null,uid:null,nick_name:null,show_head:true,show_name:true,show_cancel:false,callback:null},D);var I="jsNew";if(!z.nick_name){if(z.uid&&z.dom){I="iframe";var K=f.kit.extra.clone(z);delete K.dom;delete K.id;var O=j(K);var r=g+"?"+O;q.insertIFrame({url:r,root:z.dom,width:"210",height:"70"});return}else{z.show_head=false;z.show_name=false;I="jsOld"}}var v,F,s,E,L,H,P=false,x,C=false;if(!z.show_head&&!z.show_name){C=true}var J=function(S){S=S||"add";var T=n[S];T.cancel=z.show_cancel;L=c(T).toString();var U=f.core.dom.builder(L);H.innerHTML="";H.appendChild(U.box);if(C){f.core.dom.addClassName(U.list.followBtn[0],"WB_widgets")}return U.list};var t=function(S){S=S||function(){};o.loadCurrentUser(x,S)};var A=function(){if(P){return}P=true;_loginCbk=function(){o.createFriendships(x,z.callback)};WB2.login(function(){u();_loginCbk()})};var w=function(){if(P){return}P=true;u(false);o.destroyFriendships(x,z.callback)};var M=function(){P=false};var G=function(S){if(I=="jsNew"){o.loadUserByName(z.nick_name,function(T){N(T,S)})}else{o.loadUserByUid(z.uid,function(T){N(T,S)})}};var N=function(V,T){if(!V){return}x=V.id;T=T||function(){};var W=f.E(z.id)||f.E(z.dom);if(C){H=W;T();return}var S=f.kit.extra.clone(z);S.user=V;var U=h(S).toString();var X=f.core.dom.builder(U);H=X.list.btnbox?X.list.btnbox[0]:null;v=X.list.nameBox?X.list.nameBox[0]:null;W.innerHTML="";W.appendChild(X.box);X=null;T()};var B=function(){M();i(E,"click",w);var S=J("add");F=S.followBtn[0];s=S.followImg[0];d(F,"click",A)};var y=function(){M();i(F,"click",A);var S=J("has");if(z.show_cancel){E=S.followCancel[0];d(E,"click",w)}s=S.followImg[0]};var Q=function(){M();i(F,"click",A);var S=J("each");if(z.show_cancel){E=S.followCancel[0];d(E,"click",w)}s=S.followImg[0]};var R=function(){M();i(F,"click",A);J("me")};var u=function(S){S=typeof S=="undefined"?true:false;if(S){f.core.dom.addClassName(F,"WB_btnA_loading")}else{s.className="WB_btnicn_loading"}};G(function(){if(WB2.checkLogin()){t()}else{B();t()}b.register("followButton",x+"_add_follow",B);b.register("followButton",x+"_has_follow",y);b.register("followButton",x+"_each_follow",Q);b.register("followButton",x+"_is_me",R);b.register("followButton",x+"_is_loading",u)});WB2.listener.register("connectButton","listenerLogin",t);WB2.listener.register("connectButton","listenerLogout",B)};WB2.widget.followButton=e})();